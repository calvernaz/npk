"use strict";

/* EXAMPLE EXECUTION (change 'npk' to your actual AWSCLI profile):
export AWS_ACCESS_KEY_ID=`aws configure get npkdirect.aws_access_key_id`;
export AWS_SECRET_ACCESS_KEY=`aws configure get npkdirect.aws_secret_access_key`;
node ./tester.js
*/

// Spot Monitor

var handler = require("./status_reporter/main");

var sim = {event: {}, context: {}};

// Performance
sim.event = JSON.parse('{"resource":"/statusreport/{proxy+}","path":"/v1/statusreport/us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/performance","httpMethod":"POST","headers":{"Accept":"application/json","CloudFront-Forwarded-Proto":"https","CloudFront-Is-Desktop-Viewer":"true","CloudFront-Is-Mobile-Viewer":"false","CloudFront-Is-SmartTV-Viewer":"false","CloudFront-Is-Tablet-Viewer":"false","CloudFront-Viewer-Country":"US","Content-Type":"application/json","Host":"api.dev.npkproject.io","User-Agent":"axios/0.18.0","Via":"1.1 2d845616bb025756fb00e75135987ac7.cloudfront.net (CloudFront)","X-Amz-Cf-Id":"F5k_a6evS6I60PfYxlYTzT3MwBmwjI1ZuPIhs8E25v5aePYPDh_oFA==","x-amz-date":"20181225T073105Z","x-amz-security-token":"FQoGZXIvYXdzEMj//////////wEaDFZu80fZ2w5lZZ68EyK3Ax2qWWamqYb+lpkW2bonDGA0BZtaQmGAOQCwg7xwU7FIWLplZq4kkPCT31xV6z9VZ/rTqDsdwFu/+cECfTGzQj9RZwkonD044R5vM/mD0nq4ILzUuE/S33ZaKLfI8U42QVLfrUNRX1v9yYuOSvpfVZ4wwHhwaHhFHHGgucisCqBS7U9e5HqI6Oz+4ILldLukDFSycyiKhMuSlFOPGeIBZopcJIVCIeQ6LQExIw6Kbz49ctL2MJJj2Ew0w/xZeJkumU8NQMx6Nwvj0DPR3zBVMNnGqGdXmwgQORINje6n/3iE2EneFGkDAJlREKnModwxwXuJ9s9LaX/H942DCrzq6C36AEVpsLKrwVv2FCfj09fNU2KIY+iT0SDOWRTunH+lN52N/vghHDTginDpprcgwOzSjFnhkVfmPfViqFPqOPavL4I5LBTcOW3hUiDu0VZ5N04aqpq/JwpvxC+febK89AsabNyR7WFtbGxiLO+h81pKpqSWcv+sUewlWNWmsRjODC/8y4tbtqy8X6gI1G8Z6bI4niWKYmOmYt846KoJjDEsNKt9t3tonlSsS6T9rpH0HMDysTsonwcoiaaH4QU=","X-Amzn-Trace-Id":"Root=1-5c21dcb9-29301160d0ba84a98728f1d6","X-Forwarded-For":"54.213.33.212, 52.46.16.78","X-Forwarded-Port":"443","X-Forwarded-Proto":"https"},"multiValueHeaders":{"Accept":["application/json"],"CloudFront-Forwarded-Proto":["https"],"CloudFront-Is-Desktop-Viewer":["true"],"CloudFront-Is-Mobile-Viewer":["false"],"CloudFront-Is-SmartTV-Viewer":["false"],"CloudFront-Is-Tablet-Viewer":["false"],"CloudFront-Viewer-Country":["US"],"Content-Type":["application/json"],"Host":["api.dev.npkproject.io"],"User-Agent":["axios/0.18.0"],"Via":["1.1 2d845616bb025756fb00e75135987ac7.cloudfront.net (CloudFront)"],"X-Amz-Cf-Id":["F5k_a6evS6I60PfYxlYTzT3MwBmwjI1ZuPIhs8E25v5aePYPDh_oFA=="],"x-amz-date":["20181225T073105Z"],"x-amz-security-token":["FQoGZXIvYXdzEMj//////////wEaDFZu80fZ2w5lZZ68EyK3Ax2qWWamqYb+lpkW2bonDGA0BZtaQmGAOQCwg7xwU7FIWLplZq4kkPCT31xV6z9VZ/rTqDsdwFu/+cECfTGzQj9RZwkonD044R5vM/mD0nq4ILzUuE/S33ZaKLfI8U42QVLfrUNRX1v9yYuOSvpfVZ4wwHhwaHhFHHGgucisCqBS7U9e5HqI6Oz+4ILldLukDFSycyiKhMuSlFOPGeIBZopcJIVCIeQ6LQExIw6Kbz49ctL2MJJj2Ew0w/xZeJkumU8NQMx6Nwvj0DPR3zBVMNnGqGdXmwgQORINje6n/3iE2EneFGkDAJlREKnModwxwXuJ9s9LaX/H942DCrzq6C36AEVpsLKrwVv2FCfj09fNU2KIY+iT0SDOWRTunH+lN52N/vghHDTginDpprcgwOzSjFnhkVfmPfViqFPqOPavL4I5LBTcOW3hUiDu0VZ5N04aqpq/JwpvxC+febK89AsabNyR7WFtbGxiLO+h81pKpqSWcv+sUewlWNWmsRjODC/8y4tbtqy8X6gI1G8Z6bI4niWKYmOmYt846KoJjDEsNKt9t3tonlSsS6T9rpH0HMDysTsonwcoiaaH4QU="],"X-Amzn-Trace-Id":["Root=1-5c21dcb9-29301160d0ba84a98728f1d6"],"X-Forwarded-For":["54.213.33.212, 52.46.16.78"],"X-Forwarded-Port":["443"],"X-Forwarded-Proto":["https"]},"queryStringParameters":null,"multiValueQueryStringParameters":null,"pathParameters":{"proxy":"us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/performance"},"stageVariables":null,"requestContext":{"resourceId":"6d67ba","resourcePath":"/statusreport/{proxy+}","httpMethod":"POST","extendedRequestId":"Sc9s-GuuPHcFzBg=","requestTime":"25/Dec/2018:07:31:05 +0000","path":"/v1/statusreport/us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/performance","accountId":"892205115566","protocol":"HTTP/1.1","stage":"v1","domainPrefix":"api","requestTimeEpoch":1545723065494,"requestId":"09e73d36-0817-11e9-92c8-913fd5e8892e","identity":{"cognitoIdentityPoolId":null,"accountId":"892205115566","cognitoIdentityId":null,"caller":"AROAIWQI2CSQVPUSEYVOM:i-00f33a7486b893101","sourceIp":"54.213.33.212","accessKey":"ASIA47O4RVCXJPXDXVWE","cognitoAuthenticationType":null,"cognitoAuthenticationProvider":null,"userArn":"arn:aws:sts::892205115566:assumed-role/npk_instance_role_20181215023244879000000001/i-00f33a7486b893101","userAgent":"axios/0.18.0","user":"AROAIWQI2CSQVPUSEYVOM:i-00f33a7486b893101"},"domainName":"api.dev.npkproject.io","apiId":"eg8uhhcgg9"},"body":"","isBase64Encoded":false}');
sim.event.body = '{"startTime":"1543173536","estimatedEndTime":"1543173624","hashRate":8219100000,"progress":"8.764857","recoveredHashes":"0","recoveredPercentage":"0.000000","rejectedPercentage":"0.000000","performance":{"0":8219100000}}';


/* Node
sim.event = JSON.parse('{"resource":"/statusreport/{proxy+}","path":"/v1/statusreport/us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/node","httpMethod":"POST","headers":{"Accept":"application/json","CloudFront-Forwarded-Proto":"https","CloudFront-Is-Desktop-Viewer":"true","CloudFront-Is-Mobile-Viewer":"false","CloudFront-Is-SmartTV-Viewer":"false","CloudFront-Is-Tablet-Viewer":"false","CloudFront-Viewer-Country":"US","Content-Type":"application/json","Host":"api.dev.npkproject.io","User-Agent":"axios/0.18.0","Via":"1.1 2d845616bb025756fb00e75135987ac7.cloudfront.net (CloudFront)","X-Amz-Cf-Id":"F5k_a6evS6I60PfYxlYTzT3MwBmwjI1ZuPIhs8E25v5aePYPDh_oFA==","x-amz-date":"20181225T073105Z","x-amz-security-token":"FQoGZXIvYXdzEMj//////////wEaDFZu80fZ2w5lZZ68EyK3Ax2qWWamqYb+lpkW2bonDGA0BZtaQmGAOQCwg7xwU7FIWLplZq4kkPCT31xV6z9VZ/rTqDsdwFu/+cECfTGzQj9RZwkonD044R5vM/mD0nq4ILzUuE/S33ZaKLfI8U42QVLfrUNRX1v9yYuOSvpfVZ4wwHhwaHhFHHGgucisCqBS7U9e5HqI6Oz+4ILldLukDFSycyiKhMuSlFOPGeIBZopcJIVCIeQ6LQExIw6Kbz49ctL2MJJj2Ew0w/xZeJkumU8NQMx6Nwvj0DPR3zBVMNnGqGdXmwgQORINje6n/3iE2EneFGkDAJlREKnModwxwXuJ9s9LaX/H942DCrzq6C36AEVpsLKrwVv2FCfj09fNU2KIY+iT0SDOWRTunH+lN52N/vghHDTginDpprcgwOzSjFnhkVfmPfViqFPqOPavL4I5LBTcOW3hUiDu0VZ5N04aqpq/JwpvxC+febK89AsabNyR7WFtbGxiLO+h81pKpqSWcv+sUewlWNWmsRjODC/8y4tbtqy8X6gI1G8Z6bI4niWKYmOmYt846KoJjDEsNKt9t3tonlSsS6T9rpH0HMDysTsonwcoiaaH4QU=","X-Amzn-Trace-Id":"Root=1-5c21dcb9-29301160d0ba84a98728f1d6","X-Forwarded-For":"54.213.33.212, 52.46.16.78","X-Forwarded-Port":"443","X-Forwarded-Proto":"https"},"multiValueHeaders":{"Accept":["application/json"],"CloudFront-Forwarded-Proto":["https"],"CloudFront-Is-Desktop-Viewer":["true"],"CloudFront-Is-Mobile-Viewer":["false"],"CloudFront-Is-SmartTV-Viewer":["false"],"CloudFront-Is-Tablet-Viewer":["false"],"CloudFront-Viewer-Country":["US"],"Content-Type":["application/json"],"Host":["api.dev.npkproject.io"],"User-Agent":["axios/0.18.0"],"Via":["1.1 2d845616bb025756fb00e75135987ac7.cloudfront.net (CloudFront)"],"X-Amz-Cf-Id":["F5k_a6evS6I60PfYxlYTzT3MwBmwjI1ZuPIhs8E25v5aePYPDh_oFA=="],"x-amz-date":["20181225T073105Z"],"x-amz-security-token":["FQoGZXIvYXdzEMj//////////wEaDFZu80fZ2w5lZZ68EyK3Ax2qWWamqYb+lpkW2bonDGA0BZtaQmGAOQCwg7xwU7FIWLplZq4kkPCT31xV6z9VZ/rTqDsdwFu/+cECfTGzQj9RZwkonD044R5vM/mD0nq4ILzUuE/S33ZaKLfI8U42QVLfrUNRX1v9yYuOSvpfVZ4wwHhwaHhFHHGgucisCqBS7U9e5HqI6Oz+4ILldLukDFSycyiKhMuSlFOPGeIBZopcJIVCIeQ6LQExIw6Kbz49ctL2MJJj2Ew0w/xZeJkumU8NQMx6Nwvj0DPR3zBVMNnGqGdXmwgQORINje6n/3iE2EneFGkDAJlREKnModwxwXuJ9s9LaX/H942DCrzq6C36AEVpsLKrwVv2FCfj09fNU2KIY+iT0SDOWRTunH+lN52N/vghHDTginDpprcgwOzSjFnhkVfmPfViqFPqOPavL4I5LBTcOW3hUiDu0VZ5N04aqpq/JwpvxC+febK89AsabNyR7WFtbGxiLO+h81pKpqSWcv+sUewlWNWmsRjODC/8y4tbtqy8X6gI1G8Z6bI4niWKYmOmYt846KoJjDEsNKt9t3tonlSsS6T9rpH0HMDysTsonwcoiaaH4QU="],"X-Amzn-Trace-Id":["Root=1-5c21dcb9-29301160d0ba84a98728f1d6"],"X-Forwarded-For":["54.213.33.212, 52.46.16.78"],"X-Forwarded-Port":["443"],"X-Forwarded-Proto":["https"]},"queryStringParameters":null,"multiValueQueryStringParameters":null,"pathParameters":{"proxy":"us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/node"},"stageVariables":null,"requestContext":{"resourceId":"6d67ba","resourcePath":"/statusreport/{proxy+}","httpMethod":"POST","extendedRequestId":"Sc9s-GuuPHcFzBg=","requestTime":"25/Dec/2018:07:31:05 +0000","path":"/v1/statusreport/us-west-2%3Ab8eb71dd-3fe2-44ae-bfa2-0d0ab3a22743/9c3ac117-ea93-4884-8e22-67cbece8dc89/i-00f33a7486b893101/node","accountId":"892205115566","protocol":"HTTP/1.1","stage":"v1","domainPrefix":"api","requestTimeEpoch":1545723065494,"requestId":"09e73d36-0817-11e9-92c8-913fd5e8892e","identity":{"cognitoIdentityPoolId":null,"accountId":"892205115566","cognitoIdentityId":null,"caller":"AROAIWQI2CSQVPUSEYVOM:i-00f33a7486b893101","sourceIp":"54.213.33.212","accessKey":"ASIA47O4RVCXJPXDXVWE","cognitoAuthenticationType":null,"cognitoAuthenticationProvider":null,"userArn":"arn:aws:sts::892205115566:assumed-role/npk_instance_role_20181215023244879000000001/i-00f33a7486b893101","userAgent":"axios/0.18.0","user":"AROAIWQI2CSQVPUSEYVOM:i-00f33a7486b893101"},"domainName":"api.dev.npkproject.io","apiId":"eg8uhhcgg9"},"body":"","isBase64Encoded":false}');
sim.event.body = '{}';
*/

handler.main(sim.event, sim.context, function(err, data) {
	if (err) {
		throw Error(err);
	} else {
		console.log(data);
	}

	process.exit(0);
});